<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear Operators · JUDI documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">JUDI documentation</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../about/">About</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../abstract_vectors/">Abstract vectors</a></li><li><a class="tocitem" href="../data_structures/">Data Structures</a></li><li class="is-active"><a class="tocitem" href>Linear Operators</a><ul class="internal"><li><a class="tocitem" href="#judiModeling"><span>judiModeling</span></a></li><li><a class="tocitem" href="#judiJacobian"><span>judiJacobian</span></a></li><li><a class="tocitem" href="#judiProjection"><span>judiProjection</span></a></li><li><a class="tocitem" href="#judiLRWF"><span>judiLRWF</span></a></li></ul></li><li><a class="tocitem" href="../io/">Input/Output</a></li><li><a class="tocitem" href="../helper/">Helper Functions</a></li><li><a class="tocitem" href="../inversion/">Inversion</a></li><li><a class="tocitem" href="../tutorials/">Tutorial</a></li><li><a class="tocitem" href="../pysource/">Devito backend reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Linear Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear Operators</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/slimgroup/JUDI.jl/blob/master/docs/src/linear_operators.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-Operators"><a class="docs-heading-anchor" href="#Linear-Operators">Linear Operators</a><a id="Linear-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-Operators" title="Permalink"></a></h1><p>JUDI is building on <a href="https://github.com/slimgroup/JOLI.jl">JOLI.jl</a> to implement matrix-free linear operators. These operators represent the discretized wave-equations and sensitivit (Jacobian) for different acquisition schemes. </p><ul><li><a href="#Linear-Operators">Linear Operators</a></li><ul><li><a href="#judiModeling">judiModeling</a></li><li><a href="#judiJacobian">judiJacobian</a></li><li><a href="#judiProjection">judiProjection</a></li><li><a href="#judiLRWF">judiLRWF</a></li></ul></ul><h2 id="judiModeling"><a class="docs-heading-anchor" href="#judiModeling">judiModeling</a><a id="judiModeling-1"></a><a class="docs-heading-anchor-permalink" href="#judiModeling" title="Permalink"></a></h2><p>Seismic modeling operator for solving a wave equation for a given right-hand-side.</p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiModeling" href="#JUDI.judiModeling"><code>JUDI.judiModeling</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">judiModeling(info, model; options=Options())
judiModeling(model, src_geometry, rec_geometry; options=Options())
judiModeling(info, model, src_geometry, rec_geometry; options=Options())</code></pre><p>Create seismic modeling operator for a velocity model given as a <code>Model</code> structure. <code>info</code> is an <code>Info</code> structure<br/>containing necessary dimensions to set up the operator. The function also takes the source and receiver geometries<br/>as additional input arguments, which creates a combined operator <code>judiProjection*judiModeling*judiProjection&#39;</code>.</p><p><strong>Example</strong></p><p><code>Pr</code> and <code>Ps</code> are projection operatos of type <code>judiProjection</code> and<br/><code>q</code> is a data vector of type <code>judiVector</code>:</p><pre><code class="language-none">F = judiModeling(info, model)
dobs = Pr*F*Ps&#39;*q

F = judiModeling(info, model, q.geometry, rec_geometry)
dobs = F*q</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/e2307a443f75ffde1451a1916410559e512eb249/src/TimeModeling/LinearOperators/judiModeling.jl#L48-L69">source</a></section></article><p><strong>Construction:</strong></p><ul><li>Construct a modeling operator <strong>without</strong> source/receiver projections:</li></ul><pre><code class="language-julia">F = judiModeling(info, model; options=opt)</code></pre><ul><li>Construct a modeling operator <strong>with</strong> source/receiver projections:</li></ul><pre><code class="language-julia">F = judiModeling(info, model, src_geometry, rec_geometry)</code></pre><p>Not that in this case, all the information can be infered from the model and geometries. Therefore the operator can be created without the need for the <code>info</code> input:</p><pre><code class="language-julia">F = judiModeling(model, src_geometry, rec_geometry)</code></pre><ul><li>Construct a modeling operator from an <strong>existing</strong> operator without geometries and projection operators:</li></ul><pre><code class="language-julia">F = Pr*F*Ps&#39;</code></pre><p>where <code>Ps</code> and <code>Pr</code> are source/receiver projection operators of type <code>judiProjection</code>.</p><ul><li>Construct a modeling operator for <strong>extended source modeling</strong>:</li></ul><pre><code class="language-julia">F = Pr*F*Pw&#39;</code></pre><p>where <code>Pw</code> is a <code>judiLRWF</code> (low-rank-wavefield) projection operator.</p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiModeling-Tuple{Info, Model}" href="#JUDI.judiModeling-Tuple{Info, Model}"><code>JUDI.judiModeling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">judiModeling(info, model; options=Options())
judiModeling(model, src_geometry, rec_geometry; options=Options())
judiModeling(info, model, src_geometry, rec_geometry; options=Options())</code></pre><p>Create seismic modeling operator for a velocity model given as a <code>Model</code> structure. <code>info</code> is an <code>Info</code> structure<br/>containing necessary dimensions to set up the operator. The function also takes the source and receiver geometries<br/>as additional input arguments, which creates a combined operator <code>judiProjection*judiModeling*judiProjection&#39;</code>.</p><p><strong>Example</strong></p><p><code>Pr</code> and <code>Ps</code> are projection operatos of type <code>judiProjection</code> and<br/><code>q</code> is a data vector of type <code>judiVector</code>:</p><pre><code class="language-none">F = judiModeling(info, model)
dobs = Pr*F*Ps&#39;*q

F = judiModeling(info, model, q.geometry, rec_geometry)
dobs = F*q</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/e2307a443f75ffde1451a1916410559e512eb249/src/TimeModeling/LinearOperators/judiModeling.jl#L48-L69">source</a></section></article><p><strong>Accessible fields:</strong></p><pre><code class="language-julia"># Info structure
F.info

# Model structure
F.model

# Source geometry (if available)
F.srcGeometry

# Receiver geometry (if available)
F.recGeometry

# Options structure
F.options</code></pre><p><strong>Usage:</strong></p><pre><code class="language-julia"># Forward modeling (F w/ geometries)
d_obs = F*q

# Adjoint modeling (F w/ geometries)
q_ad = F&#39;*d_obs

# Forward modeling (F w/o geometries)
d_obs = Pr*F*Ps&#39;*q

# Adjoint modelng (F w/o geometries)
q_ad = Ps*F&#39;*Pr&#39;*d_obs

# Extended source modeling (F w/o geometries)
d_obs  = Pr*F*Pw&#39;*w

# Adjoint extended source modeling (F w/o geometries)
w_ad = Pw*F&#39;*Pr&#39;*d_obs

# Forward modeling and return full wavefield (F w/o geometries)
u = F*Ps&#39;*q

# Adjoint modelnig and return wavefield (F w/o geometries)
v = F&#39;*Pr&#39;*d_obs

# Forward modeling with full wavefield as source (F w/o geometries)
d_obs = Pr*F*u

# Adjoint modeling with full wavefield as source (F w/o geometries)
q_ad = Ps*F*v</code></pre><h2 id="judiJacobian"><a class="docs-heading-anchor" href="#judiJacobian">judiJacobian</a><a id="judiJacobian-1"></a><a class="docs-heading-anchor-permalink" href="#judiJacobian" title="Permalink"></a></h2><p>Jacobian of a non-linear forward modeling operator. Corresponds to linearized Born modeling (forward mode) and reverse-time migration (adjoint mode).</p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiJacobian" href="#JUDI.judiJacobian"><code>JUDI.judiJacobian</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">judiJacobian(F,q)</code></pre><p>Create a linearized modeling operator from the non-linear modeling operator <code>F</code> and <br/>the source <code>q</code>. <code>F</code> is a full modeling operator including source/receiver projections.</p><p><strong>Examples</strong></p><ol><li><p><code>F</code> is a modeling operator without source/receiver projections:</p><p>J = judiJacobian(Pr<em>F</em>Ps&#39;,q)</p></li><li><p><code>F</code> is the combined operator <code>Pr*F*Ps&#39;</code>:</p><p>J = judiJacobian(F,q)</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/e2307a443f75ffde1451a1916410559e512eb249/src/TimeModeling/LinearOperators/judiJacobian.jl#L36-L53">source</a></section><section><div><pre><code class="language-none">judiJacobianExQ(F,q)</code></pre><p>Create a linearized modeling operator from the non-linear modeling operator <code>F</code> and <br/>the source <code>q</code>. <code>F</code> is a full modeling operator including source/receiver projections. Examples ========</p><ol><li><code>F</code> is a modeling operator without source/receiver projections:  J = judiJacobianExQ(Pr<em>F</em>Ps&#39;,q)</li><li><code>F</code> is the combined operator <code>Pr*F*Ps&#39;</code>:  J = judiJacobianExQ(F,q)</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/e2307a443f75ffde1451a1916410559e512eb249/src/TimeModeling/LinearOperators/judiJacobianExtendedSource.jl#L39-L49">source</a></section></article><p><strong>Construction:</strong></p><ul><li>A <code>judiJacobian</code> operator can be create from an exisiting forward modeling operator and a source vector:</li></ul><pre><code class="language-julia">J = judiJacobian(F, q)  # F w/ geometries</code></pre><pre><code class="language-julia">J = judiJacobian(Pr*F*Ps&#39;, q)   # F w/o geometries</code></pre><p>where <code>Ps</code> and <code>Pr</code> are source/receiver projection operators of type <code>judiProjection</code>.</p><ul><li>A Jacobian can also be created for an extended source modeling operator:</li></ul><pre><code class="language-julia">J = judiJacobian(Pr*F*Pw&#39;, w)</code></pre><p>where <code>Pw</code> is a <code>judiLRWF</code> operator and <code>w</code> is a <code>judiWeights</code> vector (or 2D/3D Julia array).</p><p><strong>Accessible fields::</strong></p><pre><code class="language-julia"># Info structure
J.info

# Model structure
J.model

# Source geometry (if available)
J.srcGeometry

# Receiver geometry
J.recGeometry

# Source wavelet
J.wavelet

# Weights (extended source modeling only)
J.weights

# Options structure
J.options</code></pre><p><strong>Usage:</strong></p><pre><code class="language-julia"># Linearized modeilng
d_lin = J*dm

# RTM
rtm = J&#39;*d_lin

# Matrix-free normal operator
H = J&#39;*J</code></pre><h2 id="judiProjection"><a class="docs-heading-anchor" href="#judiProjection">judiProjection</a><a id="judiProjection-1"></a><a class="docs-heading-anchor-permalink" href="#judiProjection" title="Permalink"></a></h2><p>Abstract linear operator for source/receiver projections. A (transposed) <code>judiProjection</code> operator symbolically injects the data with which it is multiplied during modeling. If multiplied with a forward modeling operator, it samples the wavefield at the specified source/receiver locations.</p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiProjection" href="#JUDI.judiProjection"><code>JUDI.judiProjection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">judiProjection(info, geometry)</code></pre><p>Projection operator for sources/receivers to restrict or inject data at specified locations.<br/><code>info</code> is an <code>Info</code> structure and <code>geometry</code> is a <code>Geometry</code> structure with either source or<br/>receiver locations.</p><p><strong>Examples</strong></p><p><code>F</code> is a modeling operator of type <code>judiModeling</code> and <code>q</code> is a seismic source of type <code>judiVector</code>:</p><pre><code class="language-none">Pr = judiProjection(info, rec_geometry)
Ps = judiProjection(info, q.geometry)

dobs = Pr*F*Ps&#39;*q
qad = Ps*F&#39;*Pr&#39;*dobs</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/e2307a443f75ffde1451a1916410559e512eb249/src/TimeModeling/LinearOperators/judiProjection.jl#L30-L48">source</a></section></article><p><strong>Accessible fields:</strong></p><pre><code class="language-julia"># Info structure
P.info

# Source/receiver geometry
P.geometry</code></pre><p><strong>Usage:</strong></p><pre><code class="language-julia"># Multiply with judiVector to create a judiRHS
rhs1 = Pr&#39;*d_obs
rhs2 = Ps&#39;*q

# Sample wavefield at source/receiver location during modeling
d_obs = Pr*F*Ps&#39;*q
q_ad = Ps*F*Pr&#39;*d_obs</code></pre><h2 id="judiLRWF"><a class="docs-heading-anchor" href="#judiLRWF">judiLRWF</a><a id="judiLRWF-1"></a><a class="docs-heading-anchor-permalink" href="#judiLRWF" title="Permalink"></a></h2><p>Abstract linear operator for sampling a seismic wavefield as a sum over all time steps, weighted by a time-varying wavelet. Its transpose <em>injects</em> a time-varying wavelet at every grid point in the model.</p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiLRWF" href="#JUDI.judiLRWF"><code>JUDI.judiLRWF</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">judiLRWF(info, geometry)</code></pre><p>Low-rank wavefield operator which injects a wavelet q at every point of the subsurface. <br/><code>info</code> is an <code>Info</code> structure and <code>wavelet</code> is a cell array containing the wavelet(s). Examples ======== <code>F</code> is a modeling operator of type <code>judiModeling</code> and <code>w</code> is a weighting matrix of type <code>judiWeights</code>:     Pr = judiProjection(info, rec_geometry)     Pw = judiLRWF(info, q.data)     dobs = Pr<em>F</em>Pw&#39;<em>w     dw = Pw</em>F&#39;<em>Pr&#39;</em>dobs</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/e2307a443f75ffde1451a1916410559e512eb249/src/TimeModeling/LinearOperators/judiLRWF.jl#L31-L42">source</a></section></article><p><strong>Accessible fields:</strong></p><pre><code class="language-julia"># Info structure
P.info

# Wavelet of i-th source location
P.wavelet[i]</code></pre><p><strong>Usage:</strong></p><pre><code class="language-julia"># Multiply with a judiWeight vector to create a judiExtendedSource
ex_src = Pw&#39;*w

# Sample wavefield as a sum over time, weighted by the source
u_ex = Pw*F&#39;*Pr&#39;*d_obs</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../data_structures/">« Data Structures</a><a class="docs-footer-nextpage" href="../io/">Input/Output »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 20 April 2022 17:25">Wednesday 20 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
