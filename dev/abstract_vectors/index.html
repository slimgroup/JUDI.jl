<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Abstract vectors · JUDI documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">JUDI documentation</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../about/">About</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../basics/">Getting Started</a></li><li><span class="tocitem">JUDI API</span><ul><li class="is-active"><a class="tocitem" href>Abstract vectors</a><ul class="internal"><li><a class="tocitem" href="#judiVector"><span>judiVector</span></a></li><li><a class="tocitem" href="#judiWavefield"><span>judiWavefield</span></a></li><li><a class="tocitem" href="#judiRHS"><span>judiRHS</span></a></li><li><a class="tocitem" href="#judiWeights"><span>judiWeights</span></a></li></ul></li><li><a class="tocitem" href="../data_structures/">Data Structures</a></li><li><a class="tocitem" href="../linear_operators/">Linear Operators</a></li><li><a class="tocitem" href="../preconditioners/">Preconditioners</a></li><li><a class="tocitem" href="../io/">Input/Output</a></li><li><a class="tocitem" href="../helper/">Helper Functions</a></li></ul></li><li><a class="tocitem" href="../inversion/">Inversion</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/01_intro/">Introduction to JUDI</a></li><li><a class="tocitem" href="../tutorials/02_fwi_example_NLopt/">FWI with Quasi-Newton methods from the NLopt library</a></li><li><a class="tocitem" href="../tutorials/03_constrained_fwi/">FWI Example</a></li><li><a class="tocitem" href="../tutorials/04_judi_leading_edge_tutorial/">Full-Waveform Inversion - Part 3: optimization</a></li><li><a class="tocitem" href="../tutorials/05_custom_misfit/">FWI with user provided misfit function</a></li><li><a class="tocitem" href="../tutorials/06_automatic_differentiation/">Automatic differentiation with JUDI</a></li><li><a class="tocitem" href="../tutorials/07_quickstart/">Modeling and inversion with JUDI</a></li><li><a class="tocitem" href="../tutorials/08_imaging_conditions/">Imaging conditions in JUDI</a></li></ul></li><li><a class="tocitem" href="../pysource/">Devito backend reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">JUDI API</a></li><li class="is-active"><a href>Abstract vectors</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Abstract vectors</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/slimgroup/JUDI.jl/blob/master/docs/src/abstract_vectors.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Abstract-Vectors"><a class="docs-heading-anchor" href="#Abstract-Vectors">Abstract Vectors</a><a id="Abstract-Vectors-1"></a><a class="docs-heading-anchor-permalink" href="#Abstract-Vectors" title="Permalink"></a></h1><p>JUDI provides abstract vector types that encapsulate seismic related objects. In particula, JUDI defines thre main types for seismic data <a href="#JUDI.judiVector-Union{Tuple{N}, Tuple{T}, Tuple{Geometry, Array{T, N}}} where {T, N}"><code>judiVector</code></a>, full time-space wavefields <a href="#JUDI.judiWavefield"><code>judiWavefield</code></a> and extended source weights <a href="#JUDI.judiWeights-Union{Tuple{Array{T, N}}, Tuple{N}, Tuple{T}} where {T&lt;:Real, N}"><code>judiWeights</code></a>.</p><ul><li><a href="#Abstract-Vectors">Abstract Vectors</a></li><ul><li><a href="#judiVector">judiVector</a></li><li><a href="#judiWavefield">judiWavefield</a></li><li><a href="#judiRHS">judiRHS</a></li><li><a href="#judiWeights">judiWeights</a></li></ul></ul><p>At the core of JUDI&#39;s vector types is the abstract type <code>judiMultiSourceVector</code> that represent a dimensionalized <code>Vector{Array}</code> where each sub-array correspond to a single source. All JUDI vector types inhert from this abstract type that implements most of the arithmetic and julia core utilities. As an abstract types, <code>judiMultiSourceVector</code> should not be instantiated but new concrete types based on it should be created if one desire to create its own JUDI multi-source vector type.</p><p>All sub-type of <code>judiMultiSourceVector</code> must implement the following methods to be compatible with JUDI. The following JUDI core types are examples of sub-types.</p><h2 id="judiVector"><a class="docs-heading-anchor" href="#judiVector">judiVector</a><a id="judiVector-1"></a><a class="docs-heading-anchor-permalink" href="#judiVector" title="Permalink"></a></h2><p>The class <code>judiVector</code> is the basic data structure for seismic shot records or seismic sources. From JUDI&#39;s perspective, both are treated the same and can be multiplied with modeling operators.</p><p><strong>Construction:</strong></p><p>In the most basic way, <code>judiVectors</code> are contstructed from a <code>Geometry</code> object (containing either source or receiver geometry) and a cell array of data:</p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiVector-Union{Tuple{N}, Tuple{T}, Tuple{Geometry, Array{T, N}}} where {T, N}" href="#JUDI.judiVector-Union{Tuple{N}, Tuple{T}, Tuple{Geometry, Array{T, N}}} where {T, N}"><code>JUDI.judiVector</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">judiVector
    geometry::Geometry
    data</code></pre><p>Abstract vector for seismic data. This vector-like structure contains the geometry and data for either<br/>receiver data (shot records) or source data (wavelets).</p><p><strong>Constructors</strong></p><p>Construct vector from <code>Geometry</code> structure and cell array of shot records or wavelets. The <code>data</code> keyword<br/>can also be a single (non-cell) array, in which case the data is the same for all source positions:</p><pre><code class="language-none">judiVector(geometry, data)</code></pre><p>Construct vector for observed data from <code>SegyIO.SeisBlock</code>. <code>segy_depth_key</code> is the <code>SegyIO</code> keyword <br/>that contains the receiver depth coordinate:</p><pre><code class="language-none">judiVector(SegyIO.SeisBlock; segy_depth_key=&quot;RecGroupElevation&quot;)</code></pre><p>Construct vector for observed data from out-of-core data container of type <code>SegyIO.SeisCon</code>:</p><pre><code class="language-none">judiVector(SegyIO.SeisCon; segy_depth_key=&quot;RecGroupElevation&quot;)</code></pre><p><strong>Examples</strong></p><p>(1) Construct data vector from <code>Geometry</code> structure and a cell array of shot records:</p><pre><code class="language-none">dobs = judiVector(rec_geometry, shot_records)</code></pre><p>(2) Construct data vector for a seismic wavelet (can be either cell arrays of individual<br/>wavelets or a single wavelet as an array):</p><pre><code class="language-none">q = judiVector(src_geometry, wavelet)</code></pre><p>(3) Construct data vector from <code>SegyIO.SeisBlock</code> object:</p><pre><code class="language-none">using SegyIO
seis_block = segy_read(&quot;test_file.segy&quot;)
dobs = judiVector(seis_block; segy_depth_key=&quot;RecGroupElevation&quot;)</code></pre><p>(4) Construct out-of-core data vector from <code>SegyIO.SeisCon</code> object (for large SEG-Y files):</p><pre><code class="language-none">using SegyIO
seis_container = segy_scan(&quot;/path/to/data/directory&quot;,&quot;filenames&quot;,[&quot;GroupX&quot;,&quot;GroupY&quot;,&quot;RecGroupElevation&quot;,&quot;SourceDepth&quot;,&quot;dt&quot;])
dobs = judiVector(seis_container; segy_depth_key=&quot;RecGroupElevation&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/5310f96a78f5d1572cd6f9fe8b5109bf969dbbf4/src/TimeModeling/Types/judiVector.jl#L24-L73">source</a></section></article><p><strong>Access fields (in-core data containers):</strong></p><pre><code class="language-julia"># Access i-th shot record
x.data[i]

# Extract judiVector for i-th shot
x1 = x[i]

# Access j-th receiver location of i-th shot
x.geometry.xloc[i][j]</code></pre><p><strong>Access fields (out-of-core data containers):</strong></p><pre><code class="language-julia"># Access data container of i-th shot
x.data[i]

# Read data from i-th shot into memory
x.data[i][1].data

# Access out-of-core geometry
x.geometry

# Load OOC geometry into memory
Geometry(x.geometry)</code></pre><p><strong>Operations:</strong></p><p>In-core <code>judiVectors</code> can be used like regular Julia arrays and support common operations such as:</p><pre><code class="language-julia">x = judiVector(geometry, data)

# Size (as if all data was vectorized)
size(x)

# Norms
norm(x)

# Inner product
dot(x, x)

# Addition, subtraction (geometries must match)
y = x + x
z = x - y

# Scaling
α = 2f0
y = x * α

# Concatenate
y = vcat(x, x)</code></pre><h2 id="judiWavefield"><a class="docs-heading-anchor" href="#judiWavefield">judiWavefield</a><a id="judiWavefield-1"></a><a class="docs-heading-anchor-permalink" href="#judiWavefield" title="Permalink"></a></h2><p>Abstract vector class for wavefields. </p><p><strong>Construction:</strong></p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiWavefield" href="#JUDI.judiWavefield"><code>JUDI.judiWavefield</code></a> — <span class="docstring-category">Type</span></header><section><div><p>judiWavefield         nsrc::Integer         dt::AbstractFloat         data</p><p>Abstract vector for seismic wavefields.</p><p><strong>Constructors</strong></p><p>Construct wavefield vector from an info structure, a cell array of wavefields and the computational <br/>time step dt:</p><pre><code class="language-none">judiWavefield(nsrc, dt, data)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/5310f96a78f5d1572cd6f9fe8b5109bf969dbbf4/src/TimeModeling/Types/judiWavefield.jl#L22-L39">source</a></section></article><p><strong>Access fields:</strong></p><pre><code class="language-julia"># Access wavefield from i-th shot location
u.data[i]</code></pre><p><strong>Operations:</strong></p><p>Supports some basic arithmetric operations:</p><pre><code class="language-julia"># Size 
size(u)

# Norms
norm(u)

# Inner product 
dot(u, y)

# Addition, subtraction
v = u + u
z = u - v

# Absolute value
abs(u)

# Concatenation
v = vcat(u, u)</code></pre><h2 id="judiRHS"><a class="docs-heading-anchor" href="#judiRHS">judiRHS</a><a id="judiRHS-1"></a><a class="docs-heading-anchor-permalink" href="#judiRHS" title="Permalink"></a></h2><p>Abstract vector class for a right-hand-side (RHS). A RHS has the size of a full wavefield, but only contains the data of the source wavelet of shot records in memory, as well as the geometry information of where the data is injected during modeling.</p><p><strong>Construction:</strong></p><pre><code class="language-julia">rhs = judiRHS(geometry, data)</code></pre><p>A JUDI RHS can also be constructed by multplying a <code>judiVector</code> and the corresponding transpose of a <code>judiProjection</code> operator:</p><pre><code class="language-julia">rhs1 = Ps&#39;*q
rhs2 = Pr&#39;*d_obs</code></pre><p>where <code>Ps</code> and <code>Pr</code> are <code>judiProjection</code> operators for sources and receivers respectively and <code>q</code> and <code>d_obs</code> are <code>judiVectors</code> with the source and receiver data.</p><p><strong>Access fields:</strong></p><p>Accessible fields include:</p><pre><code class="language-julia"># Source/receiver data
rhs.data

# Source/receiver geometry
rhs.geometry

# Info structure
rhs.info</code></pre><h2 id="judiWeights"><a class="docs-heading-anchor" href="#judiWeights">judiWeights</a><a id="judiWeights-1"></a><a class="docs-heading-anchor-permalink" href="#judiWeights" title="Permalink"></a></h2><p>Abstract vector class for extended source weights. The weights for each shot location have the dimensions of the model (namely <code>model.n</code>).</p><p><strong>Construction:</strong></p><article class="docstring"><header><a class="docstring-binding" id="JUDI.judiWeights-Union{Tuple{Array{T, N}}, Tuple{N}, Tuple{T}} where {T&lt;:Real, N}" href="#JUDI.judiWeights-Union{Tuple{Array{T, N}}, Tuple{N}, Tuple{T}} where {T&lt;:Real, N}"><code>JUDI.judiWeights</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">judiWeights
    nsrc
    weights</code></pre><p>Abstract vector for weighting an extended source, which is injected at every grid point, as weighted by this vector. Constructors ============ Construct vector cell array of weights. The <code>weights</code> keyword<br/>can also be a single (non-cell) array, in which case the weights are the same for all source positions:     judiWeights(weights; nsrc=1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/slimgroup/JUDI.jl/blob/5310f96a78f5d1572cd6f9fe8b5109bf969dbbf4/src/TimeModeling/Types/judiWeights.jl#L27-L37">source</a></section></article><p><strong>Parameters:</strong></p><ul><li><code>weights</code>: Cell array with one cell per shot location. Each cell contains a 2D/3D Julia array with the weights for the spatially extended source. Alternatively: pass a single Julia array which will be used for all source locations.</li></ul><p><strong>Access fields:</strong></p><pre><code class="language-julia"># Access weights of i-th shot locatoin
w.weights[i]</code></pre><p><strong>Operations:</strong></p><p>Supports the same arithmetric operations as a <code>judiVector</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../basics/">« Getting Started</a><a class="docs-footer-nextpage" href="../data_structures/">Data Structures »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 30 May 2023 18:50">Tuesday 30 May 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
